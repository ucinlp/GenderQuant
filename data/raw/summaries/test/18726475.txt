The film takes place in Bulgaria during the Russo-Turkish War. Erast Fandorin is put on the trail of a Turkish agent who is trying to disrupt the Russian advance during the Siege of Plevna. The agent, known as Enver Efendi, is a master of disguise and has excellent command of Russian.  Unlike the ending of the book, where French correspondent d'Hervais is exposed as being Anwar in disguise, in the film Anwar turns out to have been posing as a seemingly awkward and stupid Russian captain. In the book, unlike the film, Fandorin did not escape by clinging to the underbelly of a carriage but was actually released by the governor of Viddin Yusuf Pasha after winning a wager. The scene where Varvara and Fandorin flew in the balloon never took place in the book and Varvara had no role in discovering the weaknesses of the Turkish defenses. The secene in the cave with the Lieutenant Luntz did not take place in the book. The character of the homosexual Luntz was created for the movie. The homosexual nature of Kazanzaki is never alluded to in the film. In fact, Fandorin was never once shot at by Anwar Effendi in the book. In the book, the evidence for Colonel Lukan's involvement in treason was found on him and not in his tent like in the film. Colonel Lukan was killed in a duel whereby sabres were used rather than pistols. The book refers to three main failed assaults on Plevna. The film shows only two. In the book, when Fandorin hears about Osman Pasha's plans to 'surrender' he rushes to Sobolev to urge him to attack Plevna and not to the meeting point of the Turkish 'envoys'. In the film Fandorin went to Istanbul and showed up at the end in Turkish attire. In the book he never went to Istanbul and arrived wearing European clothing.