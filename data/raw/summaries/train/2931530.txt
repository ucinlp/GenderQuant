Three years after the previous movie, Marnie Piper prepares to begin a new school year in her new home. She asks the Halloweentown Witches' Council to work toward openness between Halloweentown and the mortal world. She proposes to bring a group of Halloweentown students to her own high school in the mortal world. The Council is initially apprehensive about this, mostly due to the legend of the Knights of the Iron Dagger: a fanatical knighthood who wanted to destroy all things magical. The Council, however, agrees to accept the plan after Marnie mistakenly bets "all the Cromwell magic" that her plan will work . If she does not prove she is right by midnight on Halloween, then her entire family will lose their magical abilities. The Halloweentown students consisting of an unnamed witch, Ethan Dalloway, Jessica, Pete, Chester, Natalie, Nancy, Zachary, and Bobby arrive. They are magically given human appearances to disguise their true non-human natures. School begins with Marnie acting as tour guide for the exchange group ; Aggie substitute teaching so she can be available in case of need; Cody, a new student, showing a romantic interest in Marnie; and a possible threat to the school from the Knights of the Iron Dagger. She encourages the kids to join sports teams and clubs. While Aggie proves unable to teach any subject effectively , the Halloweentown students keep to themselves, hiding in the refuge that Aggie magically creates for them in a remote student locker. Marnie gradually encourages the kids to join school activities and make new friends. Marnie's progress is interrupted by a warning that appears to be from the Knights of the Iron Dagger, then by a magical incident at the mall that results in the Halloweentown students assuming their natural appearances, by a break-in at the secret magical locker, and finally by the disappearance of one of the students. Meanwhile, Marnie's developing relationship with Cody parallels an unexpected romance beginning between Aggie and the school's principal, Phil Flanagan. Aggie suspects Cody of being the cause of the trouble, and tries to convince Marnie to halt their relationship, but Marnie in turn suspects Flanagan. They eventually discover that Flanagan is the Knight in question; he was told prior to the students' arrival that he was the last of the Order. Edgar Dalloway, head of the Witches' Council and father of one of the students, is the real root of their problems. He wants to keep Halloweentown isolated from the mortal world, and used Flanagan to ensure the failure of Marnie's project. This, he hoped, would cause a negative reaction in Halloweentown and keep the portal between Halloweentown and the mortal world closed. The Halloweentown students use the school's Halloween carnival to improve mortal attitudes toward magical folk. Their haunted house depicts the ordinary lives of creatures that have typically been seen as monsters in the mortal world, including displays like the "Monster Tea Party" and ogres "picnicking in their natural setting", and winds up boring the carnival goers. Gwen meanwhile uses a witch's glass to hunt down the missing student whom Dalloway imprisons. At the school Halloween carnival, Edgar Dalloway launches magical attacks against mortal students by bringing the inanimate monsters in the haunted house to life. The ensuing damage and panic spiral beyond Marnie's and Aggie's ability to contain them, including a reanimated skeleton which grows 30 feet tall. Flanagan incites a mob to corner the Halloweentown students. Cody shames the crowd, the students reveal themselves, and the crowd accepts them for who they are. Flanagan also renounces being a knight and accepts Aggie. Dalloway claims the Cromwell magic, but Gwen, accepting her magic abilities, has shown the evening's events to the full Witches' Council. They return the Cromwell magic, Gwen returns with the student whom Dalloway had imprisoned, and the Council imprisons Dalloway in another witches glass considering this his resignation . The portal between Halloweentown and the mortal world opens in the middle of the haunted house, and crowds of kids from Halloweentown cross over to enjoy the carnival together with mortal world kids. Marnie flies off for a romantic broom ride with Cody and, while flying over the carnival, they kiss.