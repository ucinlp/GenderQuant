While on patrol, Sharpe  and his men rout some French soldiers who have raped and murdered the inhabitants of a Spanish village. Two are captured alive. Their commander, Brigadier General Loup , attempts to bargain with Sharpe for the lives of his men, but Sharpe has them shot in front of him. Loup vows revenge as he departs. Meanwhile, Wellington ([[Hugh Fraser  receives unwanted reinforcements from the King of Spain. His Most Catholic Majesty sends his personal bodyguard, the Real Compania Irlandesa , composed of poorly-trained men of Irish descent under the command of the inexperienced Lord Kiely . Wellington doesn't trust them, not least because of reports in American newspapers that the British are committing atrocities against the Irish people. So he orders the unreliable men to garrison a fort near the French lines, where it will be easy for them to desert if they want to. He assigns Sharpe to train them and puts him under the command of former Wagonmaster-General Colonel Runciman . Kiely's wife, Lady Kiely , and his mistress, guerrilla leader Do√±a Juanita , both show up in camp. In the meantime, Sharpe has enough time to train the men and strengthen the fort's defences, so that when Loup finally attacks, he is repulsed. Afterwards, Sharpe proposes a quick surprise assault on Loup's headquarters, which is approved by Kiely, Runciman and Juanita. When Kiely learns that his wife is pregnant, he sends her away, out of harm's way, but she is captured. Juanita reveals herself to be a French agent by giving Kiely a secret ultimatum from Loup. He is to let Sharpe and his men commit themselves to the attack, then abandon them in exchange for Lady Kiely's life. It almost goes according to plan. Sharpe's men are trapped, though he himself manages to reach Kiely. When Kiely refuses to act, Sharpe fights him, only to be shot in the arm by Juanita. At that point, Kiely finally rebels. He kills Juanita and shows that she had distributed fake newspapers to undermine the Irishmen's loyalty. Together, he and Sharpe lead the attack against the French. Meanwhile, Harper, in temporary command of Sharpe's company, tricks the French by pretending to be dead. The British win the fight - although Harper is devastated by the death of his youngest rifleman, Perkins . As the battle draws to a close, Kiely is killed by Loup when he tries to free his pregnant wife. Loup is slain in turn by Sharpe.