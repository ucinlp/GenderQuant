It is 1812. General Wellesley ([[Hugh Fraser  is ready to invade Spain from Portugal. But two formidable fortresses stand in the way. When the first, Ciudad Rodrigo, is taken, Colonel Lawford is severely wounded and forced to relinquish command of the South Essex Regiment, depriving Captain Sharpe  of an influential friend. Colonel Windham , the new commander, brings his own officers, so Sharpe is demoted to lieutenant and is humiliated by being put in charge of the baggage and losing command of his "chosen men" to an aristocratic officer  who purchased the commission of the South Essex's Light Company. Worse, one of the reinforcements is Sergeant Obidiah Hakeswill , an old enemy from Sharpe's days in India. Meanwhile, Sharpe's lover, Teresa , tells him that he has a baby daughter living with her family in Badajoz, the second fortress town. Not knowing who she is, Hakeswill tries to rape her, but proves no match for her. Teresa then slips into Badajoz to spy on the French and to see her baby. To cause trouble for Sharpe, Hakeswill steals from the officers and plants a picture frame belonging to Windham in the kit of Sharpe's right hand man, Sergeant Harper . When it is found, the colonel has Harper flogged. Later, during a night skirmish, a turncoat French soldier escapes the besieged town, bearing a dispatch and a letter from Teresa, but he is shot and killed. Sharpe recovers the letter, which contains a map showing where she is staying, but on his way back Hakeswill tries to shoot Sharpe in the confusion, but kills a young ensign  who has the misfortune to step in front of him at that exact moment. Eventually the walls of Badajoz are breached, but the first assault falters. Sharpe rallies the men and leads them into the town. Hakeswill gets to Teresa first due to the letter he stole from Sharpe, Harry Price, one of Sharpe's officers, intervenes and is shot and apparently killed by Hakeswill while trying to protect Teresa.  Sharpe is not far behind and stops Hakeswill, who suffers a wound in the process, but Hakeswill still manages to get away. For his bravery and because many of the other officers have been killed, Sharpe gets back command of his Light Company. Harper is exonerated when he finds the missing portrait of Windham's wife hidden in Hakeswill's shako and returns it to the colonel.