The film is set in a mythical mountain range called Zu, which exists between Heaven and Earth. The mountains are populated by peace-keeping immortals. A demon called Insomnia desires to rule Zu and the world below; it begins wiping out the clans. In the Kunlun Mountains, Dawn sends away her disciple, King Sky. She believed their emotional attachment limits their abilities to progress. Dawn gives him her weapon, the Moon Orb, to help him train; he is to return only after attaining a higher level; if she cannot be found, the Moon Orb will find her. Moments after they parted, Insomnia attacks and disintegrates her. 200 years later, at Omei temple, Grandmaster White Brows senses darkness coming and dispatches his disciple, Red, to investigate. King Sky joins Red  and the Omei to defeat Insomnia. White Brows engages and weakens Insomnia with his weapon, the Sky Reflector; Insomnia retreats into the legendary Blood Cave; Omei's top warriors pursue Insomnia. At the cave, King Sky notices Enigma, who resembles Dawn. Focusing on the cave, White Brows warns that the cave is capable of sucking away the powers of those who venture near it. Both Red and King Sky risk their lives to battle Insomnia within the cave, but they narrowly escape after White Brows sacrifices the Sky Reflector to save them. With Insomnia absorbing the cave's energy, White Brows has Red guard the cave's entrance while the Omei reconnoiter. At Omei, White Brows tries to combine Enigma's Heaven Sword with Hollow's Thunder Sword to form a new weapon. Unfortunately, the fusion process rebounds; Hollow dies and Enigma is seriously injured, but King Sky rescues her. White Brows appears before King Sky and admits that Enigma is the reincarnation of Dawn . He then appoints King Sky as chief of Omei as he ventures into a new dimension to find a weapon to defeat Insomnia. Before leaving, he resurrects Hollow, hoping the reborn Hollow  will retain his abilities to wield the Thunder Sword in their most desperate hour. Without a wielder of the Thunder Sword, King Sky asks Enigma to help him attempt to wield the sword, but is unsuccessful and he was burned alive in the process. Enigma tries to save him, but fails and buries him. Meanwhile, Red is possessed by Amnesia  while guarding the Blood Cave. Red returns to Omei and decimates the clan and captures Enigma. Amnesia then destroys the rest of Omei, weakening the clan. To the survivors' frustration, Ying has yet to re-awaken his abilities. In a pitted fight against one of the Sword Saints, Thunder, Ying's abilities and memories return. Concurrently, through the power of resurrection, King Sky revives just in time to intercept White Brows's weapon. With his new Ming Fire Sword, both King Sky and Ying face Red at the Blood Cave. After Ying rescues Enigma, Ying and Enigma return to Omei to stop Insomnia's final assault. King Sky exorcises Red, but he sacrifices himself to finish off Amnesia. At Omei, Enigma and Ying successfully fuse their swords to form a new celestial weapon to defeat Insomnia. King Sky joins the duo and they weaken Insomnia. Enigma possesses Insomnia to prevent the demon from escaping, giving King Sky a chance to destroy it. Just as Insomnia is destroyed, Enigma remembers herself as Dawn and tells King Sky she is happy to find him again before disappearing. After the battle, Enigma is reincarnated as a new immortal and Mount Omei is restored. King Sky parts with the Omei to rebuild his clan.