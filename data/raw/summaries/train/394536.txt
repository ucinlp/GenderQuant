Infernal Affairs focuses on a police officer named Chan Wing-yan , who goes undercover into a triad, and triad member Lau Kin-ming , who infiltrates the police department. Each mole was planted by the rival organisation to gain an advantage in intelligence over the other side. The more the moles become involved in their undercover lives, the more issues they have to cope with. The prologue opens with the introduction of triad boss Hon Sam , who sends a number of young gangsters to the police academy as moles, among whom include a young Lau . Concurrently, a young Chan  joins the police force but is expelled from the academy even though he manages to impress Superintendent Wong Chi-shing and Principal Yip. In reality, Chan has become an undercover agent reporting directly only to Wong and Yip. Over time, Chan experiences great stress from work while Lau quickly rises through the ranks in the police department. The film begins with a meeting between Chan and Lau in a hi-fi store without either of them knowing the other's identity. Soon after, Chan attends the funeral of Yip, who had died recently, leaving Wong as the only person who can identify Chan as a cop. Wong and his team interrupt a deal between Hon Sam and a Thai cocaine dealer after receiving a tip-off from Chan using Morse code, but Lau alerted Hon, giving Hon enough time to order his minions to dispose of the cocaine, eliminating solid evidence of the drug deal. After the incident, Wong and Hon are both aware that they each have a mole within their respective organisations, placing them in a race against time to root out the other mole. Later, Chan sees Hon conversing with Lau at a cinema but does not see Lau's face clearly. He attempts to follow Lau secretly as they leave, but loses his target when his phone rings suddenly at the crucial moment. By this time, both Chan and Lau are struggling with their double identities – Chan starts losing faith in himself as a cop after being a gangster for ten years; Lau becomes more accustomed to the life of a police officer and he wants to erase his criminal background. When Chan meets Wong again on the same rooftop, Wong intends to pull Chan out of undercover work for fear of his safety. They are unaware that Lau has his subordinate, CIB Inspector B, and his team tracking him. Meanwhile, Hon sends Tsui Wai-keung, Del Piero, and a gang of henchmen to confront them after receiving intel from Lau. Inspector B informs Lau and sends an OCTB squad to save Wong. Chan flees from the building using a crane while Wong sacrifices himself to save Chan by distracting the thugs. Wong is recognised by the gangsters, who beat him up severely before throwing him off the roof. As the police close in, a shootout breaks out, resulting in three gangsters being killed, one of whom is Piero. In the aftermath of the gunfight, the OCTB squad arrives with Lau and Wong's second-in-command, Inspector Cheung, on the scene. Lau retrieves Wong's cellphone and contacts Chan, with both of them reaching an agreement to foil a drug deal by Hon. The plan succeeds and many of Hon's men are arrested, while Lau betrays Hon and kills him. Everything seems to have returned to normal – Chan can revert to his true identity as a cop, while Lau has erased his criminal connections by eliminating Hon's triad. However, back at the police station, Chan discovers that Lau was the mole and he leaves immediately. Lau, realising what has happened, erases Chan's records as a cop from the police database. Chan spends an evening with his therapist Lee , with whom he has fallen in love. He sends to Lau a compact disc with a recording that Hon kept between himself and Lau, but the disc is inadvertently intercepted by Lau's girlfriend Mary . Chan and Lau meet on the same rooftop where Wong was killed earlier. Chan disarms Lau without resistance and holds his Glock 17 to Lau's head, as a rebuke to Lau's plea for forgiveness and request to remain as a cop. Inspector B arrives on the scene shortly and orders Chan to release Lau. Chan holds Lau as a hostage at gunpoint and backs into an elevator, but upon moving his head from behind Lau he is suddenly shot in the head by Inspector B. Inspector B then reveals to Lau that he is also a mole planted by Hon. As they take the elevator down to the lobby, Lau kills B, most likely out of his desire to eradicate traces of his past and become a "good guy" cop and end the hunt for a mole. The original ending climaxes with Lau identifying himself to the police as one of them. Dr. Lee Sum-yee discovers Yip's records at the academy, revealing Chan as the undercover officer; B is blamed of being the mole and the case is closed. Lau salutes Chan at his funeral, with Cheung and Lee present as well. A flashback reaffirms the point that Lau wished he had taken a different route in life. In Mainland China, an alternate ending for the film was created. In this ending, Lau exits the elevator and is informed by Cheung that the police have found evidence that he was a mole. Lau hands them his badge and is arrested without protest. The sequel, Infernal Affairs III, uses the original ending instead of the alternate one.