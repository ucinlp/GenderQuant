 In 1931, China is embroiled in a civil war. Friends of British Captain Donald "Doc" Harvey  envy him because the fabulously notorious Shanghai Lily is a fellow passenger on the express train from Beiping to Shanghai. When the name means nothing to him, they inform him that she is a "coaster" or "woman who lives by her wits along the China coast" â€“ in other words, a courtesan. On the journey, Harvey encounters his former lover, Magdalen . Five years earlier, she had played a trick on Harvey to gauge his love for her, but it backfired and he left her. She frankly informs him that, in the interim, "It took more than one man to change my name to Shanghai Lily." Lily makes it clear that she still cares deeply for him. It becomes apparent that his feelings also have not changed. Among the other passengers are fellow coaster Hui Fei , zealous missionary Mr. Carmichael , inveterate gambler Sam Salt , opium dealer Eric Baum , boarding house keeper Mrs. Haggerty , French officer Major Lenard , and a mysterious Eurasian, Henry Chang . Government soldiers search the train and arrest an enemy agent. Immediately afterwards, Chang sends a coded telegram. The train is taken over by rebels loyal to a powerful warlord, who turns out to be Chang. Chang questions the passengers, looking for someone important enough to exchange for his valued aide, the man who was taken earlier. He finds what he wants in Harvey, who is on his way to perform brain surgery on the Governor-General of Shanghai. Chang offers to take Shanghai Lily to his palace, but she claims she has reformed. Overhearing from the next room, Harvey breaks in and knocks Chang down. Because he needs Harvey alive, Chang swallows  the insult and leaves them alone. He then has Hui Fei forcibly brought to him to spend the night. The government releases Chang's man, but Chang decides to blind Harvey for his insolence. Out of love, Lily offers herself in return for Harvey's safe release. Harvey remains unaware of the danger he is in and Lily's reason for going with Chang. Then, Chang is stabbed to death by Hui Fei. When she informs Harvey, he finds Lily. They board the train and depart before the body is discovered. Carmichael, trusting his instincts, gets Lily to tell him the truth about her self-sacrifice. She insists that he not enlighten Harvey, because love must go hand in hand with faith. In the end, at the Shanghai train station, Harvey finally acknowledges his love for her.