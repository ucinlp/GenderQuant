The story, loosely based on actual events, takes place in March 1943, when World War II was at its height. The cryptanalysts at Bletchley Park, Buckinghamshire, have a problem: the Nazi U-boats have changed one of their code reference books used for Enigma machine ciphers, leading to a blackout in the flow of vital naval signals intelligence. The British cryptanalysts have cracked the "Shark" cipher once before, and they need to do it again in order to keep track of U-boat locations. The film begins with Jericho returning to Bletchley after a month recovering from a nervous breakdown brought on by his failed love affair with Claire. Jericho immediately tries to see her again and finds that she mysteriously disappeared a few days earlier. He enlists the help of Claire's housemate Hester Wallace, to follow the trail of clues and learn what has happened to Claire. Mr. Jericho and Miss Wallace, as they formally address each other, work to decipher intercepts stolen by Claire and determine why she took them. Jericho is closely watched by an MI5 agent, Wigram , who plays cat and mouse with him throughout the film. Meanwhile U-Boats closing in on one of the ship convoys from America allow Jericho and the team to work on breaking back into reading Shark. Jericho and Hester's research uncovers the British government's cover-up of the Katyn Massacre for fear knowledge of it might weaken American willingness to remain in the war on the same side as Joseph Stalin. Cryptanalyst Jozef 'Puck' Pukowski , working at the Park, learned of Katyn from Claire and was so incensed by the massacre – which claimed the life of his brother – that he set about betraying Bletchley's secrets to the Nazis in order to take revenge on Stalin. Claire is presumed dead as Jericho trails Puck to Scotland and catches up with him just as he is about to be taken on board a U-boat, but Wigram and the police have been waiting for the sub and it is bombed and sunk. A short scene after the war sees Jericho and Hester married with a child on the way. As Jericho waits for her in London, he notices Claire walking across the square.