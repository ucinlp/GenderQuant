Infernal Affairs III uses parallel storytelling, flashing between the past and the present.  Undercover cop Chan Wing-yan seeks to uncover the link between triad boss Hon Sam and the mysterious Mainland Chinese triad boss Shen Cheng. Since Hon's ascension to the seat of triad boss was due to Ngai Wing-hau's death in Infernal Affairs II, Hon is suspicious of all his followers for fear they might usurp his position. He tests Chan's loyalty by ordering Chan to smash an ashtray on Shen's brother during a negotiation, resulting in Chan's arrest by Inspector Yeung Kam-wing. Yeung tells Chan that though Chan doesn't recognise him, Yeung recognises Chan and warns him to "be careful". After being released, Tsui Wai-keung  smashes a bottle of liquor on himself and Shen smashes one on Chan, after which Shen calls for a truce between his and Hon's triad. Concurrently, Chan is prosecuted by the police for violent behaviour. His superior, Superintendent Wong Chi-shing, persuades the court to allow Chan to see a psychologist instead of serving jail. Chan meets Dr. Lee Sum-yee regularly for psychological therapy. Hon asks Chan to deliver arms to Shen but he and other triad members do not turn up. When Chan delivers the cargo, Shen's men discover that the boxes are empty, and they open fire at Chan. Shen and Chan shoot each other in the limbs during the crossfire. Shen finds out that Chan is an undercover cop when Yeung unexpectedly arrives on the scene. Yeung tells Chan that Shen is actually also an undercover cop from the Mainland. Yeung also tells Chan that he gained top honours when he was in the police academy due to Chan's "expulsion". The three shake hands and wait for the mayhem to subside before returning to their bases.  Former triad mole-turned-cop Lau Kin-ming has been demoted to administrative duty pending an investigation into the deaths of Chan and Billy . Lau claims that Billy shot Chan in the head while holding him hostage, and he killed Billy in retaliation. In fact, Chan was holding Lau hostage after discovering that Lau was the mole, but was shot by Billy, who turned out to be also a triad mole. Lau killed Billy after that to erase traces of his criminal connections. After months of investigation, Lau is transferred back to Internal Affairs Department. He struggles to whitewash his past and cover his true identity. Just then, he learns that Hon Sam had previously planted five moles in the police force, one of whom might be a fellow Security Division Inspector, Yeung. A battle of wits develops between Lau and Yeung, as each of them tries to discover the other's secret. Meanwhile, Lau suffers from an identity collapse as he loses track of reality, wrestling with guilt over Chan's murder, and an impending divorce with his wife, Mary. His psychological trauma deteriorates to the point where he begins to see himself as Chan. As "Chan", Lau makes it a personal mission to apprehend Yeung, whom he sees as his former "triad mole" self. After witnessing an incident where Lau suffers a hallucination, Dr. Lee conducts a hypnosis on him and finds out that he was Hon's mole. Lau realizes his folly and knocks Lee unconscious before escaping. Lau steals tapes from Yeung's office safe, using his spy cameras to determine the code. He thinks he hears recordings of Yeung relating information to Hon, and so leads his team to the Security Division. He is announcing that he is arresting Yeung as Shen arrives. Lau plays a tape recording, which is actually the conversation between him and Hon in the movie theatre as seen in Infernal Affairs. When Lau's second-in-command tries to arrest him instead, Lau panics and draws his gun, asking for a chance to be a good guy, but Yeung declares, "sorry, I'm a cop."  Lau yells, "I'm a cop too!" and shoots Yeung in the forehead, killing him on the spot. He is immediately shot by Shen in the next instant and attempts suicide by shooting himself in the neck. During a search of Lau's office, a tape is found in his safe and played. It is the song that Mary, Sam's wife, gave him in Infernal Affairs II.  A series of flashbacks play: immediately after Chan's death, Shen and Yeung meet. Shen suspects Lau. Yeung breaks into Lau's office to find tape recordings of his conversations with Hon, proving that Shen is right. Yeung is buried next to Chan in the police cemetery. Shen and Dr. Lee visit the graves and Shen says to Lee: "Events change men, but men do not change events. But these two men are extraordinary because they changed events." Lau ends up crippled and catatonic, lost inside his own mind, haunted by the spirit of Mary  and locked in his own "continuous hell". His divorced wife Mary visits and tells him, "Our baby can say "papa" now." Before the picture fades into the next scene, the camera pans down onto Lau's fingers tapping out in Morse code, "H-E-L..." . Before the film ends, there is one final flashback to the hi-fi shop scene in Infernal Affairs, where Lau is buying an audio system from Chan.