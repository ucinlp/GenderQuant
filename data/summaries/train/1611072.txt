America has lost the war on drugs. Substance D, a powerful drug causing bizarre hallucinations, has swept the country. In response, the government develops an invasive, high-tech surveillance system and a network of undercover informants. Bob Arctor is a detective assigned to immerse himself in the drugs underworld and infiltrate the supply chain. Arctor and his housemates, Luckman and Barris, live in a run-down suburban house in Anaheim. They pass their days taking drugs and having long, paranoiac conversations. At the police station, Arctor is codenamed Fred and maintains privacy by wearing a "scramble suit" that constantly changes every aspect of his appearance. Arctor's senior officer Hank, and all other undercover officers, also wear scramble suits. Whilst undercover, Arctor becomes addicted to Substance D. Arctor also befriends a cocaine addict named Donna; she is Arctor's supplier. Arctor hopes to purchase large enough quantities of Substance D from Donna that she is forced to introduce him to her own supplier, but he also develops romantic feelings towards her. Donna rejects Arctor's sexual advances, and Barris questions the nature of their relationship. Hank orders Fred to step up surveillance on the group. Hank suggests that Fred concentrate his surveillance on the suspected ringleader, Arctor, thereby ordering him to spy on himself. Meanwhile, the justified paranoia of Arctor's housemates reaches extreme levels, and he becomes wrapped up in their concerns. Barris secretly contacts the police and tells them he suspects Donna and Arctor of being terrorists; he unknowingly conveys this information to Arctor at the police station, in his scramble-suited role of Detective Fred. Arctor's prolonged use of Substance D damages his brain, causing him increasingly to lose track of his identity, and the fact that "Fred" and Arctor are the same person. After Barris supplies the police with a faked recording allegedly proving his claims about Donna and Arctor, Hank orders that Barris be held on charges of providing false information. After Barris's arrest, Hank reveals to Fred that he has deduced his true identity by a process of elimination. "Fred" is surprised to learn that he is really Arctor, and becomes disoriented. Hank informs him that the real purpose of the surveillance was to catch Barris, not Arctor; the police suspected Barris of being involved in the Substance D supply chain, and were deliberately increasing his paranoia until he attempted to cover his tracks. Hank reprimands Arctor for becoming addicted to Substance D, and warns him that he will be disciplined. As Arctor undergoes a mental breakdown in the office, Hank phones Donna and asks her to take Arctor to New Path, a corporation that runs a series of rehabilitation clinics. After Arctor leaves the office, Hank enters the locker room and removes his scramble suit, revealing his true identity to the audience—Donna. At New Path, Arctor experiences the symptoms of Substance D withdrawal, including more severe brain damage. Some time later Donna, whose real name is Audrey, converses with a fellow police officer, and the audience learns that New Path is responsible for the manufacture and distribution of Substance D; ironically they use victims of the drug to tend their crops, since  they can be trusted not to reveal New Path's secret. Audrey and Mike are part of a police operation to infiltrate New Path, and Arctor was selected—without his knowledge—to carry out the sting. The police had intended for Arctor to become addicted to Substance D; his health was sacrificed so that he might enter a rehabilitation center unnoticed as a genuine addict. They debate whether enough of Arctor's mind will recover that he grasps the situation and returns with evidence. New Path sends Arctor to work at an isolated New Path farming prison, where he spots rows of blue flowers hidden between rows of corn. These flowers, referenced throughout the film, are the source of Substance D. As the film ends, Arctor hides a blue flower in his boot, so that when he returns to the New Path clinic during Thanksgiving he can give it to his friends.