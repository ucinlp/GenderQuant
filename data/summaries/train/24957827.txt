It is the Ming Dynasty and bonfires burn in a moonlit wasteland. Yehe Changgong duels with Manchu warrior Nalan but purposely loses and relinquishes his title of Supreme Master of Martial Arts. He retires to the sleepy Sideroad Town, nestled in the shadow of the Imperial City, where he intends to see out the rest of his days peacefully, playing his erhu. Mingyue Xin catches his eye and they begin a musical duel, half seduction, and half stand-off. They agree to meet on the roof of the Royal Palace at the next full moon to finish their sonata. However, their night time rendezvous coincides with a break-in at the Palace by three masked thieves hoping to steal a rumoured treasure map. However, they are beaten to the punch by Xin, a ninja in disguise, who they pursue across the rooftops before cornering her at Lanruo Temple. Changgong pursues them and saves Xin from the clutches of the thieves. In the scuffle, the map is lost and with all five participants injured, they have no choice but to limp off their separate ways until they can track it down. Cut to five years later and the treasure-seeking warriors have come no closer to finding their prize, but have each assumed the disguise of a normal villager. Changgong and Xin run a restaurant - the Dragon Inn - with their adopted daughter Xiaowei, while the three thieves pass themselves off as a shopkeeper, singer and monk. They're all under the thumb of the young landowner, Lord Xu, a spoilt rich kid with a soft spot for Xiaowei. He struggles to gain the respect of the villagers and to collect their rent, until he lets obliviously slip that he is the custodian of the treasure map. Later mayor Gu Yuejin accidentally sends a pigeon about the treasure in the Imperial City. Loads of army come including the second army, led by Nalan. Xin, Xiaowei and Xu follow the treasure to claim the treasure while Changgong and Nalan engage in another duel. All five of them later encountered the treasure which turns out to be a spade. Nalan throws the spade away but later falls on him, killing him. The film ends with a party of all the citizens of the Sideroad Town.