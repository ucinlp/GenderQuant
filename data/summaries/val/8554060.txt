The plot is, on the whole, close to Gogol's classic tale. The action is set in a Cossack stanitsa. On Christmas Eve, a minor demon arrives to a local witch called Solokha. They both ride on the witch's broom, after which the demon steals the Moon and hides in an old rag. In the ensuing darkness, some inebriated Cossacks can't find their way to a shinok  and decide to go home. One by one, they each come to visit Soloha, who hides each one  in bags so that none of them see each other.  At the same time, Solokha's son Vakula the Metalsmith , tries to woo the beauty Oksana , but she laughs at him and demands that he find her the shoes which the Tsarina wears. Vakula goes to Soloha in sadness, but upon coming there sees the bags and decides to take them to the forge. Getting tired along the way, he leaves the heaviest bags on the street, which are picked up by a caroling company. Vakula, who is left only with the bag containing the demon, goes to Patsyuk, a sorcerer, to ask him how to find a demon - only with the help of a demon can he hope to get Tsarina's shoes. The Patsyuk answers that a person should not search for a demon if he has a demon behind his back. Vakula takes it as some kind of a murky wise say, but indeed eventually finds the demon in the bag and forces him to take him to St. Petersburg. There, Prince Potemkin takes him for an ambassador of the Zaporozhian Cossacks and gives him Tsarina's shoes. The demon takes Vakula home and Vakula lets him go. Oksana agrees to marry Vakula.