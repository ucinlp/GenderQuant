In October 1956, Ronnie , a Dutch woman married to a Canadian clergyman, is on a package tour of Israel. While visiting a kibbutz, she sees the local schoolteacher, Rachel Rosenthal , and they realise they knew each other during World War II. As Rachel recalls the past near a riverbank, the film then flashes back to 1944, and begins the story of Rachel Stein, a Dutch Jewish singer who had lived in Berlin before the war and is now hiding from the Nazi regime in the occupied Netherlands.  When the farmhouse where she had been hiding is accidentally destroyed by an American bomber, Rachel manages to escape thanks to a local boy, Rob, and visits a lawyer named Smaal , who provides her with some of her father's money so that she can flee, helped by a member of the Resistance named Van Gein . Rachel and Rob are reunited with her family and try to flee by boat through the Biesbosch with them and other Jews from the Nazi-occupied part of the Netherlands to the liberated southern part of the country. However, it turns out to be a trap. They are ambushed on the river by members of the German SS, who kill them and rob the bodies of their cash and other valuables. Rachel alone survives, but she does not manage to escape from occupied territory. Using a non-Jewish alias, Ellis de Vries, Rachel becomes involved with a Resistance group in the Hague, under the leadership of Gerben Kuipers  and working closely with a doctor in the Resistance, Hans Akkermans . Smaal is in touch with this Resistance cell. When Kuipers' son and other members of the Resistance are captured, Ellis agrees to help by seducing local SD commander Hauptsturmführer Ludwig Müntze , bleaching her hair blonde. Müntze invites her to a party at the local SD headquarters, and there, Ellis recognises Obersturmführer Günther Franken , Müntze's brutal deputy, as the SS officer who oversaw the massacre of her refugee party. She obtains a job as a secretary at the SD headquarters while also falling in love with Müntze, who, in contrast to Franken, is not abusive or sadistic. He works out that her hair is bleached and she is a Jew, but does not care. She also becomes friends with her Dutch colleague Ronnie, who collaborates with the Germans, working for them, being sexually available to them , and accepting stolen gifts from them. Thanks to a bug Ellis manages to plant in Franken's office, the Resistance works out that it was Van Gein who betrayed Rachel, her family and the other Jews to the SS in return for a cut of the profits. Going against Kuipers' orders, Akkermans and others decide to abduct Van Gein to expose the suspected traitor. The plot goes wrong when Akkermans' chloroform fails to work, Van Gein fights back and is killed. Franken responds by planning to kill forty hostages, including most of the plotters, but Müntze, who realises the war is lost and has been negotiating with the Resistance, cancels the order. Müntze confronts Ellis as being a member of the Resistance. He demands that she tell him her story, which she does. On this evidence he confronts Franken with a superior and Franken is ordered to open his safe, in a search for the money, gold and jewels stolen from the Jews he had killed. Murdering Jews was not against SS regulations, but personally stealing their wealth was a capital offense. When opened by the commanding officer, Obergruppenführer Käutner , however, the safe reveals nothing. Realizing that Müntze is now a danger to him, the apparently angry and embarrassed Franken reveals to Käutner that Müntze has been negotiating with Dutch resistance "terrorists" for a truce. Müntze is condemned to death and imprisoned, along with the members of the resistance cell Franken was already planning to shoot as a reprisal for the killing of Van Gein. Ellis agrees to participate in a rescue attempt for the resistance prisoners only on the condition that they free Müntze too and, albeit reluctantly, the others agree. The plan has been betrayed by an unknown insider, and the would-be rescuers find the prisoners' cells to be filled with German troops. Only Akkermans and another resister survive the "rescue". Ellis is subsequently arrested by Franken and taken to his office, the one she bugged. Franken has known about her and the bug all the time. Knowing that the resistance is listening in, he stages a confrontation to make the resistance group believe Ellis is the Nazi collaborator, responsible for the catastrophic failure of the rescue operation. Hearing this, Kuipers and his companions swear to hunt her down and make her pay for her treason. Ronnie, having learned of Ellis's role with the Resistance, helps Ellis and Müntze escape. When the country is liberated by the Allies, Franken attempts to escape by boat, but is killed by Akkermans. Ronnie, instead of being imprisoned or publicly shamed as a collaborator, latches on to a Canadian captain whom she subsequently marries. Suspecting Smaal is the traitor, Müntze and Ellis return to confront him. Smaal, who has asked the Canadians for protection as refugee, denies the accusations. He shows them the titular black book in which he had detailed all his dealings with the Jews he helped. He and his wife have a theory about who the insider is and agrees to tell it to Ellis only if she goes with them. However, both are murdered before they can escape. Not getting a good look at the killer, Müntze chases him into the street, only to be recognized by the triumphant Dutch and arrested by the Canadians. The Dutch also recognize Ellis and arrest her as a "collaborator", but not before she grabs the black book. Müntze is brought before the ranking Canadian forces only to find that they have enlisted the assistance of Käutner in keeping order among the defeated German forces. Käutner convinces a Canadian colonel that under military law the defeated German military retains the right to punish its own soldiers. He then finds the death warrant he previously issued against Müntze for his negotiations with Ellis's resistance cell. Although initially opposing the idea of murdering a witness, the Canadian colonel finally agrees, and Müntze is immediately executed by a firing squad of German troops. Ellis is imprisoned with other accused collaborators, humiliated and tortured by the violently anti-Nazi volunteer jailers, but is rescued by Akkermans, now a colonel in the Dutch Army, who calls the jailers no better than the Nazis. Bringing her to his medical office, Akkermans tells Ellis that he killed Franken when the Nazi tried to escape, and shows her the cash and jewels stolen from Franken's Jewish victims. When informed about Müntze's fate, Ellis goes in shock, and is administered a tranquilizer by Akkermans. Feeling dizzy, Ellis grasps that Akkermans is trying to kill her with an overdose of insulin, and realizes that he had been the traitor with Franken, and the one murderer of the Smaals. While Akkermans is distracted playing hero to a crowd that heralds him, she survives by quickly eating a bar of chocolate to counteract the insulin and, staggering, jumps from Akkermans' balcony into the crowd below and runs away. He tries to follow her, but is blocked by the very same people cheering him as the hero of the Resistance. Ellis proves her innocence to the British intelligence and to the former Resistance leader Gerben Kuipers by means of Smaal's black book, which lists how many Jews  were secretly taken to Akkermans for medical help just prior to their murders. Together, Ellis and Kuipers intercept the fleeing Akkermans, who is hiding in a coffin in a hearse, filled with the stolen money, gold and jewels. They quickly dispatch the accomplice driver, and while Kuipers drives, Ellis screws down the coffin's secret air vents using the locket with the pictures of her murdered family. They drive to Hollands Diep where the SS trap had been sprung, and wait until Akkermans suffocates. Ellis and Kruipers are left wondering what to do with the stolen money and jewels. The scene changes to Israel in 1956, as Rachel meets her husband and their two children at the end of the day, walking back into Kibbutz Stein, which a sign at the gate announces was funded with the recovered money stolen from Jews killed during the war. As the film ends, a jeep passes by Rachel and her family as Israeli soldiers arrive to protect the kibbutz as the Suez Crisis begins.