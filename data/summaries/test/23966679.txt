 Kenji Koiso  is a young high school student with a gift in mathematics and a part-time moderator in the massive computer-simulated virtual reality world OZ along with his friend Takashi Sakuma . Invited by Natsuki Shinohara  to participate in the 90th birthday of her great-grandmother Sakae Jinnouchi  Kenji travels with her to Sakae's estate in Ueda. While there, Natsuki introduces Kenji as her fiancé to Sakae. Kenji meets several of Natsuki's relatives and discovers that the Jinnouchis are descendants of a samurai who challenged the Tokugawa clan in 1615. He also meets Wabisuke Jinnouchi , Natsuki's half-granduncle and a computer expert who has been living in the United States since stealing the family's fortunes 10 years ago. Kenji receives an e-mail with a mathematical code and cracks it. Love Machine, an artificial intelligence in the OZ infrastructure, uses Kenji's account and his avatar to invade the infrastructure, causing widespread damage. Kenji, Natsuki's cousin Kazuma Ikezawa  and Sakuma confront Love Machine. Love Machine defeats Kazuma's avatar King Kazma and continues to steal accounts, creating catastrophic traffic congestions and disabling electrical devices. Two of Sakae's relatives&nbsp;— Rika  and Shota Jinnouchi &nbsp;– discover Kenji's involvement. Shota arrests Kenji, but Natsuki has them return to the estate due to the ongoing traffic congestions. Recognizing the situation as akin to war, Sakae calls her associates in important positions in Japan's society and her relatives who work in emergency services. She encourages them to work their hardest to reduce the potential chaos and damage that could have occurred. Kenji is able to return control of the virtual world to the moderators and engineers. Wabisuke reveals that he created Love Machine and sold the program to the United States Armed Forces for a test run. After an argument with Sakae, Wabisuke leaves the estate. Sakae later encourages Kenji to take care of Natsuki during a Hanafuda match; and Kenji and the Jinnouchis, running to Sakae's bedside the next morning, find Sakae dead. Her youngest son Mansaku  reveals she had angina and Love Machine had deactivated her heart monitor. Kenji, Sakuma, and most of the Jinnouchis initiate a plan to defeat Love Machine using a supercomputer with ice blocks as a coolant while Natsuki and the others prepare a funeral for Sakae. Kenji, along with Sakuma and the others, capture Love Machine. However, Shota carries the ice blocks to Sakae's body causing the supercomputer to overheat; whereupon Love Machine empowers itself and assimilates King Kazma; then redirects the Arawashi Asteroid Probe onto a collision course with a nuclear power plant. At the same time, Natsuki discovers a will left by Sakae before reuniting with Kenji and the rest of the group. Natsuki has Wabisuke return home before the family reads Sakae's will, asking them to bring Wabisuke back to their lives. Realizing that Love Machine sees everything as a game, Kenji has the Jinnouchis play Koi-Koi with Love Machine in OZ's casino world, wagering their accounts in a desperate attempt to stop Love Machine. Natsuki wins several rounds, but gets distracted and nearly loses her "winnings". However, OZ users worldwide enter their own accounts into the wager on Natsuki's side. Natsuki critically damages Love Machine, but the artificial intelligence redirects the Arawashi towards a collision on Sakae's estate. Kenji hacks into the probe's GPS, but is unsuccessful. To circumvent Love Machine, Wabisuke disables its defenses, distracting it long enough for King Kazma to be revived and assisted by several Jinnouchi family avatars before destroying Love Machine. Kenji activates the GPS code and redirects the Arawashi away from the estate. The satellite's impact destroys the estate's entrance and causes a geyser to erupt. The Jinnouchi family, celebrating their victory as well as Sakae's birthday, has Natsuki kiss Kenji after confessing their love to each other.