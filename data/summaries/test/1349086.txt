Colin Sullivan  is introduced to organized crime by Irish-American mobster Frank Costello  in the Irish neighborhood of South Boston. Costello trains him to become a mole inside the Massachusetts State Police. Sullivan is accepted into the Special Investigations Unit, which focuses on organized crime. Before he graduates from the police academy, Billy Costigan  is asked by Captain Queenan  and Staff Sergeant Dignam  to go undercover, as his family ties to organized crime make him a perfect infiltrator. He drops out of the academy and does time in prison on a fake assault charge to increase his credibility. As both infiltrate their respective organizations, Sullivan begins a romance with psychiatrist Madolyn Madden . Costigan sees her for his probation and also develops a relationship with her. After Costello escapes a sting operation, both moles become aware of the other's existence. Sullivan is told to find the "rat" and asks Costello for information to determine who is the informer within his crew. Costigan follows Costello into a movie theater where Costello gives Sullivan an envelope containing personal information on his crew members. Costigan then chases Sullivan through Chinatown. When it is over, neither man knows the other's identity. Sullivan has Queenan tailed to a meeting with Costigan. Costello's men go in and Queenan is killed. When they exit, Costigan pretends he has come to join them. Later, Costello's henchman, Fitzgibbons , reveals that Delahunt , a crew member, was an undercover cop. Dignam is forced to step down as a consequence. Using Queenan's phone, Sullivan reaches Costigan, who refuses to abort his mission. Sullivan learns of Costello's role as an informant for the Federal Bureau of Investigation from Queenan's diary, causing him to worry about his identity being revealed. With Costigan's help, Costello is traced to a cocaine drop-off, where a gunfight erupts between his crew and police, resulting in most of the crew being killed. Costello, confronted by Sullivan, admits he is an occasional FBI informant. Sullivan then shoots him multiple times. With Costello dead, Sullivan is applauded the next day by everyone on the force. In good faith, Costigan comes to him for restoration of his true identity, but notices the envelope from Costello on Sullivan's desk and flees. Knowing he has been found out, Sullivan erases all records of Costigan from the police computer system. Madolyn tells Sullivan that she is pregnant, but does not reveal who the father is. Later, she discovers a package from Costigan containing a CD with recordings of Costello's conversations with Sullivan. Sullivan walks in as she is listening and tries unsuccessfully to assuage her suspicions. He contacts Costigan, who reveals that Costello recorded every conversation he had with Sullivan. Costello's attorney left Costigan in possession of the recordings and he intends to implicate Sullivan. They agree to meet at the building where Queenan died. On the roof, Costigan catches Sullivan off-guard and handcuffs him. As Costigan had secretly arranged, Officer Brown appears on the roof as well. Shocked, Brown draws his gun on Costigan, who attempts to justify his actions by exposing Sullivan as the rat. Costigan asks Brown why Dignam did not accompany him, but Brown does not answer. Costigan leads Sullivan to the elevator. When it reaches the ground floor, Costigan is shot in the head by Officer Barrigan, who then shoots Brown and reveals to Sullivan that Costello had more than one mole in the police. When Barrigan turns, Sullivan shoots him in the head. At police headquarters, Sullivan identifies Barrigan as the mole and has Costigan posthumously given the Medal of Merit. At Costigan's funeral, Sullivan and Madolyn stand at the grave. Sullivan attempts to talk to her, but she ignores him. When Sullivan enters his apartment, Dignam, wearing hospital footies and surgical gloves, shoots him in the head with a silenced pistol.